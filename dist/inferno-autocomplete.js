!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("inferno-component"),require("inferno"),require("inferno-create-element"),require("inferno-compat")):"function"==typeof define&&define.amd?define(["inferno-component","inferno","inferno-create-element","inferno-compat"],t):e.Autocomplete=t(e.infernoComponent,e.inferno,e.createElement,e.React)}(this,function(e,t,n,i){"use strict";n="default"in n?n.default:n,i="default"in i?i.default:i;var o=Object.assign||function(e){for(var t=arguments,n=1;n<arguments.length;n++){var i=t[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},r=require("dom-scroll-into-view"),s=[],p=function(e){function p(t){e.call(this,t);var n=this;this.refs={},this.keyDownHandlers={ArrowDown:function(e){e.preventDefault();var t=n.getFilteredItems().length;if(t){var i=n.state,o=i.highlightedIndex,r=null===o||o===t-1?0:o+1;n._performAutoCompleteOnKeyUp=!0,n.setState({highlightedIndex:r,isOpen:!0})}},ArrowUp:function(e){e.preventDefault();var t=n.getFilteredItems().length;if(t){var i=n.state,o=i.highlightedIndex,r=0===o||null===o?t-1:o-1;n._performAutoCompleteOnKeyUp=!0,n.setState({highlightedIndex:r,isOpen:!0})}},Enter:function(e){if(n.state.isOpen!==!1)if(null==n.state.highlightedIndex)n.setState({isOpen:!1},function(){n.refs.input.select()});else{e.preventDefault();var t=n.getFilteredItems()[n.state.highlightedIndex],i=n.props.getItemValue(t);n.setState({isOpen:!1,highlightedIndex:null},function(){n.refs.input.setSelectionRange(i.length,i.length),n.props.onSelect(i,t)})}},Escape:function(e){n.setState({highlightedIndex:null,isOpen:!1})}},this.state={isOpen:!1,highlightedIndex:null,value:"",wrapperProps:{},wrapperStyle:{display:"inline-block"},inputProps:{},onChange:function(){},onSelect:function(e,t){},renderMenu:function(e,t,o){return i.createElement("div",{style:Object.assign({},o,n.menuStyle),children:e})},shouldItemRender:function(){return!0},menuStyle:{borderRadius:"3px",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.9)",padding:"2px 0",fontSize:"90%",position:"fixed",overflow:"auto",maxHeight:"50%"},autoHighlight:!0,onMenuVisibilityChange:function(){}}}return e&&(p.__proto__=e),p.prototype=Object.create(e&&e.prototype),p.prototype.constructor=p,p.prototype.getDefaultProps=function(){return{value:"",wrapperProps:{},wrapperStyle:{display:"inline-block"},inputProps:{},onChange:function(){},onSelect:function(e,t){},renderMenu:function(e,t,i){return n("div",{style:o({},i,this.menuStyle),children:e})},shouldItemRender:function(){return!0},menuStyle:{borderRadius:"3px",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.9)",padding:"2px 0",fontSize:"90%",position:"fixed",overflow:"auto",maxHeight:"50%"},autoHighlight:!0,onMenuVisibilityChange:function(){}}},p.prototype.getInitialState=function(){return{isOpen:!1,highlightedIndex:null}},p.prototype.componentWillMount=function(){this._ignoreBlur=!1,this._performAutoCompleteOnUpdate=!1,this._performAutoCompleteOnKeyUp=!1},p.prototype.componentWillReceiveProps=function(e){this._performAutoCompleteOnUpdate=!0,(this.props.items!==e.items||this.state.highlightedIndex>=e.items.length)&&this.setState({highlightedIndex:null})},p.prototype.componentDidUpdate=function(e,t){this.state.isOpen===!0&&t.isOpen===!1&&this.setMenuPositions(),this.state.isOpen&&this._performAutoCompleteOnUpdate&&(this._performAutoCompleteOnUpdate=!1,this.maybeAutoCompleteText()),this.maybeScrollItemIntoView(),t.isOpen!==this.state.isOpen&&(this.props.onMenuVisibilityChange||function(){})(this.state.isOpen)},p.prototype.maybeScrollItemIntoView=function(){if(this.state.isOpen===!0&&null!==this.state.highlightedIndex){var e=t.findDOMNode(this.refs["item-"+this.state.highlightedIndex]),n=t.findDOMNode(this.refs.menu);e&&n&&r(t.findDOMNode(e),t.findDOMNode(n),{onlyScrollIfNeeded:!0})}},p.prototype.handleKeyDown=function(e){this.keyDownHandlers[e.key]?this.keyDownHandlers[e.key].call(this,e):this.setState({highlightedIndex:null,isOpen:!0})},p.prototype.handleChange=function(e){this._performAutoCompleteOnKeyUp=!0,this.props.onChange(e,e.target.value)},p.prototype.handleKeyUp=function(){this._performAutoCompleteOnKeyUp&&(this._performAutoCompleteOnKeyUp=!1,this.maybeAutoCompleteText())},p.prototype.getFilteredItems=function(){var e=this,t=this.props.items||[];return this.props.shouldItemRender&&(t=t.filter(function(t){return e.props.shouldItemRender(t,e.props.value)})),this.props.sortItems&&t.sort(function(t,n){return e.props.sortItems(t,n,e.props.value)}),t},p.prototype.maybeAutoCompleteText=function(){if(this.props.autoHighlight&&""!==this.props.value){var e=this.state,t=e.highlightedIndex,n=this.getFilteredItems();if(0!==n.length){var i=null!==t?n[t]:n[0],o=this.props.getItemValue(i),r=0===o.toLowerCase().indexOf(this.props.value.toLowerCase());r&&null===t&&this.setState({highlightedIndex:0})}}},p.prototype.setMenuPositions=function(){var e=this.refs.input,t=e.getBoundingClientRect(),n=global.window.getComputedStyle(e),i=parseInt(n.marginBottom,10)||0,o=parseInt(n.marginLeft,10)||0,r=parseInt(n.marginRight,10)||0;this.setState({menuTop:t.bottom+i,menuLeft:t.left+o,menuWidth:t.width+o+r})},p.prototype.highlightItemFromMouse=function(e){this.setState({highlightedIndex:e})},p.prototype.selectItemFromMouse=function(e){var t=this.props.getItemValue(e);this.setState({isOpen:!1,highlightedIndex:null}),this.props.onSelect(t,e),this.props.value=t,this.refs.input.focus()},p.prototype.setIgnoreBlur=function(e){this._ignoreBlur=e},p.prototype.renderMenu=function(){var e=this,t=this,n=this.getFilteredItems().map(function(n,o){var r=e.props.renderItem(n,e.state.highlightedIndex===o,{cursor:"default"});r.ref=function(){return"item-"+o};var s=i.cloneElement(r,{onMouseDown:function(){return e.setIgnoreBlur(!0).bind(t)},onMouseEnter:function(){return e.highlightItemFromMouse(o)},onClick:function(){return e.selectItemFromMouse(n)},ref:function(){return"item-"+o}});return t.refs[s.ref()]=s,s}),r={left:this.state.menuLeft,top:this.state.menuTop,minWidth:this.state.menuWidth},s=(this.props.renderMenu||function(e,n,r){return i.createElement("div",Object.assign({},t.props,{style:o({},r,t.menuStyle),children:e}))})(n,this.props.value,r),p=i.cloneElement(s,{ref:function(){return"menu"}});return p.ref=function(){return"menu"},t.refs.menu=p,p},p.prototype.handleInputBlur=function(){this._ignoreBlur||this.setState({isOpen:!1,highlightedIndex:null})},p.prototype.handleInputFocus=function(){return this._ignoreBlur?void this.setIgnoreBlur(!1):(this._ignoreClick=!0,void this.setState({isOpen:!0}))},p.prototype.isInputFocused=function(e){return e.ownerDocument&&e===e.ownerDocument.activeElement},p.prototype.handleInputClick=function(e){this.isInputFocused(e.target)&&this.state.isOpen===!1?this.setState({isOpen:!0}):null===this.state.highlightedIndex||this._ignoreClick||this.selectItemFromMouse(this.getFilteredItems()[this.state.highlightedIndex]),this._ignoreClick=!1},p.prototype.composeEventHandlers=function(e,t){return t?function(n){e(n),t(n)}:e},p.prototype.render=function(){var e=this;this.props.debug&&s.push({id:s.length,state:this.state});var t=this.props,n=t.inputProps;return i.createElement("div",Object.assign({},{style:Object.assign({},this.props.wrapperStyle)},this.props.wrapperProps),i.createElement("input",Object.assign({},n,{role:"combobox","aria-autocomplete":"list",autoComplete:"off",ref:"input",onFocus:function(t){e.handleInputFocus(t),n.onFocus&&n.onFocus(t)},onBlur:function(t){e.handleInputBlur(t),n.onBlur&&n.onBlur(t)},onChange:function(t){e.handleChange(t)},onKeyDown:function(t){e.handleKeyDown(t),n.onKeyDown&&n.onKeyDown(t)},onKeyUp:function(t){e.handleKeyUp(t),n.onKeyUp&&n.onKeyUp(t)},onClick:function(t){e.handleInputClick(t),n.onClick&&n.onClick(t)},value:this.props.value})),("open"in this.props?this.props.open:this.state.isOpen)&&this.renderMenu(),this.props.debug&&i.createElement("pre",{style:{marginLeft:300}},JSON.stringify(s.slice(s.length-5,s.length),null,2)))},p}(i.Component);return p});
