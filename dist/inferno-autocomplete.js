!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("inferno-create-element"),require("inferno"),require("inferno-component"),require("inferno-compat"),require("dom-scroll-into-view")):"function"==typeof define&&define.amd?define(["inferno-create-element","inferno","inferno-component","inferno-compat","dom-scroll-into-view"],t):e.Autocomplete=t(e.createElement,e.inferno,e.Component,e.React,e.scrollIntoView)}(this,function(e,t,n,i,o){"use strict";e="default"in e?e.default:e,t="default"in t?t.default:t,n="default"in n?n.default:n;var r="default"in i?i.default:i;o="default"in o?o.default:o;var s=Object.assign||function(e){for(var t=arguments,n=1;n<arguments.length;n++){var i=t[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},p=[],u=function(t){function n(e){t.call(this,e);var n=this;this.refs={id:e.inputProps.id},this.keyDownHandlers={ArrowDown:function(e){e.preventDefault();var t=n.getFilteredItems().length;if(t){var i=n.state,o=i.highlightedIndex,r=null===o||o===t-1?0:o+1;n._performAutoCompleteOnKeyUp=!0,n.setState({highlightedIndex:r,isOpen:!0})}},ArrowUp:function(e){e.preventDefault();var t=n.getFilteredItems().length;if(t){var i=n.state,o=i.highlightedIndex,r=0===o||null===o?t-1:o-1;n._performAutoCompleteOnKeyUp=!0,n.setState({highlightedIndex:r,isOpen:!0})}},Enter:function(e){if(n.state.isOpen!==!1)if(null==n.state.highlightedIndex)n.setState({isOpen:!1},function(){var e=document.getElementById(n.refs.id);e.select()});else{e.preventDefault();var t=n.getFilteredItems()[n.state.highlightedIndex],i=n.props.getItemValue(t);n.setState({isOpen:!1,highlightedIndex:null},function(){var e=document.getElementById(n.refs.id);e.setSelectionRange(i.length,i.length),n.props.onSelect(i,t)})}},Escape:function(e){n.setState({highlightedIndex:null,isOpen:!1})}},this.state={isOpen:!1,highlightedIndex:null,value:"",wrapperProps:{},wrapperStyle:{display:"inline-block"},inputProps:{},onChange:function(){},onSelect:function(e,t){},renderMenu:function(e,t,i){return r.createElement("div",{style:Object.assign({},i,n.menuStyle),children:e})},shouldItemRender:function(){return!0},menuStyle:{borderRadius:"3px",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.9)",padding:"2px 0",fontSize:"90%",position:"fixed",overflow:"auto",maxHeight:"50%"},autoHighlight:!0,onMenuVisibilityChange:function(){}}}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.getDefaultProps=function(){return{value:"",wrapperProps:{},wrapperStyle:{display:"inline-block"},inputProps:{},onChange:function(){},onSelect:function(e,t){},renderMenu:function(t,n,i){return e("div",{style:s({},i,this.menuStyle),children:t})},shouldItemRender:function(){return!0},menuStyle:{borderRadius:"3px",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.9)",padding:"2px 0",fontSize:"90%",position:"fixed",overflow:"auto",maxHeight:"50%"},autoHighlight:!0,onMenuVisibilityChange:function(){}}},n.prototype.getInitialState=function(){return{isOpen:!1,highlightedIndex:null}},n.prototype.componentWillMount=function(){this._ignoreBlur=!1,this._performAutoCompleteOnUpdate=!1,this._performAutoCompleteOnKeyUp=!1},n.prototype.componentWillReceiveProps=function(e){this._performAutoCompleteOnUpdate=!0,(this.props.items!==e.items||this.state.highlightedIndex>=e.items.length)&&this.setState({highlightedIndex:null})},n.prototype.componentDidUpdate=function(e,t){this.state.isOpen===!0&&t.isOpen===!1&&this.setMenuPositions(),this.state.isOpen&&this._performAutoCompleteOnUpdate&&(this._performAutoCompleteOnUpdate=!1,this.maybeAutoCompleteText()),this.maybeScrollItemIntoView(),t.isOpen!==this.state.isOpen&&(this.props.onMenuVisibilityChange||function(){})(this.state.isOpen)},n.prototype.maybeScrollItemIntoView=function(){if(this.state.isOpen===!0&&null!==this.state.highlightedIndex){var e=i.findDOMNode(this.refs["item-"+this.state.highlightedIndex]),t=i.findDOMNode(this.refs.menu);e&&t&&o(i.findDOMNode(e),i.findDOMNode(t),{onlyScrollIfNeeded:!0})}},n.prototype.handleKeyDown=function(e){this.keyDownHandlers[e.key]?this.keyDownHandlers[e.key].call(this,e):this.setState({highlightedIndex:null,isOpen:!0})},n.prototype.handleChange=function(e){this._performAutoCompleteOnKeyUp=!0,this.props.onChange(e,e.target.value)},n.prototype.handleKeyUp=function(){this._performAutoCompleteOnKeyUp&&(this._performAutoCompleteOnKeyUp=!1,this.maybeAutoCompleteText())},n.prototype.getFilteredItems=function(){var e=this,t=this.props.items||[];return this.props.shouldItemRender&&(t=t.filter(function(t){return e.props.shouldItemRender(t,e.props.value)})),this.props.sortItems&&t.sort(function(t,n){return e.props.sortItems(t,n,e.props.value)}),t},n.prototype.maybeAutoCompleteText=function(){if(this.props.autoHighlight&&""!==this.props.value){var e=this.state,t=e.highlightedIndex,n=this.getFilteredItems();if(0!==n.length){var i=null!==t?n[t]:n[0],o=this.props.getItemValue(i),r=0===o.toLowerCase().indexOf(this.props.value.toLowerCase());r&&null===t&&this.setState({highlightedIndex:0})}}},n.prototype.setMenuPositions=function(){var e=document.getElementById(this.refs.id),t=e.getBoundingClientRect(),n=global.window.getComputedStyle(e),i=parseInt(n.marginBottom,10)||0,o=parseInt(n.marginLeft,10)||0,r=parseInt(n.marginRight,10)||0;this.setState({menuTop:t.bottom+i,menuLeft:t.left+o,menuWidth:t.width+o+r})},n.prototype.highlightItemFromMouse=function(e){this.setState({highlightedIndex:e})},n.prototype.selectItemFromMouse=function(e){var t=this.props.getItemValue(e);this.setState({isOpen:!1,highlightedIndex:null}),this.props.onSelect(t,e),this.props.value=t,this.refs.input.focus()},n.prototype.setIgnoreBlur=function(e){this._ignoreBlur=e},n.prototype.renderMenu=function(){var t=this,n=this,i=this.getFilteredItems().map(function(e,i){var o=t.props.renderItem(e,t.state.highlightedIndex===i,{cursor:"default"});o.ref=function(){return"item-"+i};var s=r.cloneElement(o,{onMouseDown:function(){return t.setIgnoreBlur(!0).bind(n)},onMouseEnter:function(){return t.highlightItemFromMouse(i)},onClick:function(){return t.selectItemFromMouse(e)},ref:function(){return"item-"+i}});return n.refs[s.ref()]=s,s}),o={left:this.state.menuLeft,top:this.state.menuTop,minWidth:this.state.menuWidth},p=(this.props.renderMenu||function(t,i,o){return e("div",Object.assign({},n.props,{style:s({},o,n.menuStyle),children:t}))})(i,this.props.value,o),u=r.cloneElement(p,{ref:function(){return"menu"}});return u.ref=function(){return"menu"},n.refs.menu=u,u},n.prototype.handleInputBlur=function(){this._ignoreBlur||this.setState({isOpen:!1,highlightedIndex:null})},n.prototype.handleInputFocus=function(){return this._ignoreBlur?void this.setIgnoreBlur(!1):(this._ignoreClick=!0,void this.setState({isOpen:!0}))},n.prototype.isInputFocused=function(e){return e.ownerDocument&&e===e.ownerDocument.activeElement},n.prototype.handleInputClick=function(e){this.isInputFocused(e.target)&&this.state.isOpen===!1?this.setState({isOpen:!0}):null===this.state.highlightedIndex||this._ignoreClick||this.selectItemFromMouse(this.getFilteredItems()[this.state.highlightedIndex]),this._ignoreClick=!1},n.prototype.composeEventHandlers=function(e,t){return t?function(n){e(n),t(n)}:e},n.prototype.render=function(){var e=this,t=this.props,n=t.inputProps;return r.createElement("div",Object.assign({},{style:Object.assign({},this.props.wrapperStyle)},this.props.wrapperProps),r.createElement("input",Object.assign({},n,{role:"combobox","aria-autocomplete":"list",autoComplete:"off",ref:function(){return"input"},onFocus:function(t){e.handleInputFocus(t),n.onFocus&&n.onFocus(t)},onBlur:function(t){e.handleInputBlur(t),n.onBlur&&n.onBlur(t)},onInput:function(t){e.handleChange(t)},onKeyDown:function(t){e.handleKeyDown(t),n.onKeyDown&&n.onKeyDown(t)},onKeyUp:function(t){e.handleKeyUp(t),n.onKeyUp&&n.onKeyUp(t)},onClick:function(t){e.handleInputClick(t),n.onClick&&n.onClick(t)},value:this.props.value})),("open"in this.props?this.props.open:this.state.isOpen)&&this.renderMenu(),this.props.debug&&r.createElement("pre",{style:{marginLeft:300}},JSON.stringify(p.slice(p.length-5,p.length),null,2)))},n}(n);return u});
